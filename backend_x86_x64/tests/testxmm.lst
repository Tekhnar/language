     1                                                                                  ; Console Message, 64 bit. V1.03
     2                                  NULL              EQU 0                         ; Constants
     3                                  STD_OUTPUT_HANDLE EQU -11
     4                                  
     5                                  extern GetStdHandle                             ; Import external symbols
     6                                  extern WriteFile                                ; Windows API functions, not decorated
     7                                  extern ExitProcess
     8                                  extern WriteConsoleA
     9                                  
    10                                  global Start                                    ; Export symbols. The entry point
    11                                  
    12                                  section .data                                   ; Initialized data segment
    13 00000000 436F6E736F6C65204D-      Message        db "Console Message 64", 0Dh, 0Ah
    13 00000009 657373616765203634-
    13 00000012 0D0A               
    14                                   MessageLength  EQU $-Message                   ; Address of this line ($) - address of Message
    15                                  
    16                                  
    17                                  section .text                                   ; Code segment
    18                                  Start:
    19                                  
    20 00000000 90                      nop
    21 00000001 90                      nop
    22 00000002 90                      nop
    23 00000003 90                      nop
    24 00000004 90                      nop
    25 00000005 90                      nop
    26 00000006 90                      nop
    27 00000007 90                      nop
    28                                  
    29 00000008 DF2424                  fbld [rsp]
    30                                  
    31 0000000B 90                      nop
    32 0000000C 90                      nop
    33 0000000D 90                      nop
    34                                  fistp [rsp]
    34          ******************       error: operation size not specified
    35                                  
    36 0000000E 90                      nop
    37 0000000F 90                      nop
    38 00000010 90                      nop
    39 00000011 90                      nop
    40 00000012 90                      nop
    41 00000013 90                      nop
    42 00000014 90                      nop
    43 00000015 4883EC00                 sub   RSP, 0                                   ; Align the stack to a multiple of 16 bytes
    44 00000019 4883EC20                 sub   RSP, 32                                  ; 32 bytes of shadow space
    45 0000001D B9F5FFFFFF               mov   ECX, STD_OUTPUT_HANDLE
    46 00000022 E8(00000000)             call  GetStdHandle
    47 00000027 4889C1                   mov   rcx, RAX
    48 0000002A 4883C420                 add   RSP, 32                                  ; Remove the 32 bytes
    49 0000002E 4883EC28                 sub   RSP, 32 + 8                          ; Shadow space + 5th parameter + align stack
    50                                                                                  ; to a multiple of 16 bytes
    51 00000032 488D15(00000000)         lea   RDX, [REL Message]                       ; 2nd parameter
    52 00000039 41B80A000000             mov   R8, 10                        ; 3rd parameter
    53 0000003F 41B900000000             mov   R9, 0                        ; 4th parameter
    54 00000045 48C744242000000000       mov   qword [RSP + 4 * 8], NULL                ; 5th parameter
    55 0000004E E8(00000000)             call  WriteConsoleA                                ; Output can be redirect to a file using >
    56 00000053 4883C428                 add   RSP, 40                                  ; Remove the 48 bytes
    57                                  
    58 00000057 31C9                     xor   ECX, ECX
    59 00000059 E8(00000000)             call  ExitProcess
